<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Integration Manager</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .nav-tabs {
            display: flex;
            background: #34495e;
            overflow-x: auto;
        }

        .nav-tab {
            flex: 1;
            padding: 15px 20px;
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .nav-tab:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .nav-tab.active {
            background: white;
            color: #34495e;
        }

        .tab-content {
            padding: 30px;
            min-height: 600px;
        }

        .form-section {
            display: none;
        }

        .form-section.active {
            display: block;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #2980b9, #1f639a);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #27ae60, #229954);
            color: white;
        }

        .btn-success:hover {
            background: linear-gradient(135deg, #229954, #1e8449);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }

        .mapping-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 20px;
        }

        .mapping-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
        }

        .mapping-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .mapping-item {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            gap: 10px;
        }

        .field-display {
            background: white;
            padding: 8px 12px;
            border-radius: 5px;
            flex: 1;
            border: 1px solid #dee2e6;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }

        .arrow {
            font-size: 20px;
            color: #3498db;
            font-weight: bold;
        }

        .result-container {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }

        .success {
            border-left-color: #27ae60;
            background: #d5f4e6;
        }

        .error {
            border-left-color: #e74c3c;
            background: #fdeaea;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .gatepass-entry {
            background: #fff;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .gatepass-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .detail-item {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
        }

        .detail-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }

        .detail-value {
            font-weight: 600;
            color: #2c3e50;
        }

        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .items-table th,
        .items-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .items-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .mapping-container {
                grid-template-columns: 1fr;
            }
            
            .nav-tab {
                font-size: 12px;
                padding: 12px 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>API Integration Manager</h1>
            <p>Unicommerce ↔ Logic ERP Data Transfer</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('endpoints')">API Endpoints</button>
            <button class="nav-tab" onclick="switchTab('parameters')">Request Parameters</button>
            <button class="nav-tab" onclick="switchTab('mapping')">Field Mapping</button>
            <button class="nav-tab" onclick="switchTab('transfer')">Data Transfer</button>
        </div>

        <div class="tab-content">
            <!-- API Endpoints Tab -->
            <div id="endpoints" class="form-section active">
                <h2>API Endpoints & Authentication</h2>
                
                <div class="mapping-container">
                    <div class="mapping-section">
                        <h3>Unicommerce API Configuration</h3>
                        <div class="form-group">
                            <label>Endpoint URL</label>
                            <input type="text" id="unicommerceEndpoint" value="/services/rest/v1/purchase/gatepass/get" placeholder="API Endpoint">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Request Type</label>
                                <select id="unicommerceMethod">
                                    <option value="POST" selected>POST</option>
                                    <option value="GET">GET</option>
                                    <option value="PUT">PUT</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Scheme</label>
                                <select id="unicommerceScheme">
                                    <option value="HTTPS" selected>HTTPS</option>
                                    <option value="HTTP">HTTP</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Access Token</label>
                            <input type="text" id="unicommerceToken" placeholder="Bearer Token">
                        </div>
                        <div class="form-group">
                            <label>Facility Code</label>
                            <input type="text" id="unicommerceFacility" placeholder="Facility Code">
                        </div>
                    </div>

                    <div class="mapping-section">
                        <h3>Logic ERP API Configuration</h3>
                        <div class="form-group">
                            <label>Endpoint URL</label>
                            <input type="text" id="logicEndpoint" value="http://demo.logicerp.com/api/SaveSaleInvoice" placeholder="API Endpoint">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Request Type</label>
                                <select id="logicMethod">
                                    <option value="POST" selected>POST</option>
                                    <option value="GET">GET</option>
                                    <option value="PUT">PUT</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Auth Type</label>
                                <select id="logicAuthType">
                                    <option value="basic" selected>Basic Auth</option>
                                    <option value="bearer">Bearer Token</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Username</label>
                                <input type="text" id="logicUsername" value="Demo" placeholder="Username">
                            </div>
                            <div class="form-group">
                                <label>Password</label>
                                <input type="password" id="logicPassword" value="1" placeholder="Password">
                            </div>
                        </div>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="saveEndpoints()">Save Configuration</button>
                
                <div id="endpointResult" class="result-container" style="display: none;">
                    <h4>Configuration Status</h4>
                    <p id="endpointMessage"></p>
                </div>
            </div>

            <!-- Request Parameters Tab -->
            <div id="parameters" class="form-section">
                <h2>Request Parameters Configuration</h2>
                
                <div class="mapping-container">
                    <div class="mapping-section">
                        <h3>Unicommerce Request Parameters</h3>
                        <div class="form-group">
                            <label>Request Structure</label>
                            <textarea id="unicommerceParams" rows="8" placeholder="JSON Request Parameters">
{
    "gatePassCodes": [
        "GPJ1000214"
    ]
}
                            </textarea>
                        </div>
                        <div class="form-group">
                            <label>Headers</label>
                            <textarea id="unicommerceHeaders" rows="4">
Content-Type: application/json
Authorization: bearer {access-token}
Facility: {facility-code}
                            </textarea>
                        </div>
                    </div>

                    <div class="mapping-section">
                        <h3>Logic ERP Request Parameters</h3>
                        <div class="form-group">
                            <label>Request Structure</label>
                            <textarea id="logicParams" rows="12" placeholder="JSON Request Parameters">
{
    "Remarks3": "",
    "CreditDays": 0.0,
    "Sale_Bill_Date": "",
    "OrderNo": "1011",
    "OrderDate": "22/06/23",
    "Gst_State_Code": "",
    "GRNo": "",
    "GRDate": "",
    "BillSeries": "WSL",
    "Bill_Number": 0,
    "Bill_Date": "22/06/2023",
    "PartyUserCode": "99004477",
    "ActEntryPartyUserCode": "",
    "BranchCode": 2,
    "Tax_Region": "",
    "LstItems": []
}
                            </textarea>
                        </div>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="saveParameters()">Save Parameters</button>

                <div id="parameterResult" class="result-container" style="display: none;">
                    <h4>Parameters Status</h4>
                    <p id="parameterMessage"></p>
                </div>
            </div>

            <!-- Field Mapping Tab -->
            <div id="mapping" class="form-section">
                <h2>Field Mapping Configuration</h2>
                
                <div class="mapping-container">
                    <div class="mapping-section">
                        <h3>Unicommerce Response Fields</h3>
                        <div class="mapping-item">
                            <div class="field-display">elements[0].code</div>
                            <div class="arrow">→</div>
                            <div class="field-display">OrderNo</div>
                        </div>
                        <div class="mapping-item">
                            <div class="field-display">elements[0].created</div>
                            <div class="arrow">→</div>
                            <div class="field-display">OrderDate</div>
                        </div>
                        <div class="mapping-item">
                            <div class="field-display">elements[0].toPartyName</div>
                            <div class="arrow">→</div>
                            <div class="field-display">PartyUserCode</div>
                        </div>
                        <div class="mapping-item">
                            <div class="field-display">elements[0].updated</div>
                            <div class="arrow">→</div>
                            <div class="field-display">Bill_Date</div>
                        </div>
                    </div>

                    <div class="mapping-section">
                        <h3>Item Level Mapping</h3>
                        <div class="mapping-item">
                            <div class="field-display">gatePassItemDTOs[i].itemTypeSKU</div>
                            <div class="arrow">→</div>
                            <div class="field-display">LstItems[i].LogicUserCode</div>
                        </div>
                        <div class="mapping-item">
                            <div class="field-display">gatePassItemDTOs[i].itemCode</div>
                            <div class="arrow">→</div>
                            <div class="field-display">LstItems[i].AddlItemCode</div>
                        </div>
                        <div class="mapping-item">
                            <div class="field-display">gatePassItemDTOs[i].quantity</div>
                            <div class="arrow">→</div>
                            <div class="field-display">LstItems[i].Quantity</div>
                        </div>
                        <div class="mapping-item">
                            <div class="field-display">gatePassItemDTOs[i].unitPrice</div>
                            <div class="arrow">→</div>
                            <div class="field-display">LstItems[i].Rate</div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Custom Mapping Rules (JSON)</label>
                    <textarea id="customMapping" rows="8" placeholder="Define custom field mappings">
{
    "staticFields": {
        "BillSeries": "WSL",
        "BranchCode": 2,
        "CreditDays": 0.0
    },
    "dynamicMapping": {
        "elements[0].code": "OrderNo",
        "elements[0].toPartyName": "PartyUserCode",
        "gatePassItemDTOs": "LstItems"
    }
}
                    </textarea>
                </div>

                <button class="btn btn-primary" onclick="saveMapping()">Save Field Mapping</button>

                <div id="mappingResult" class="result-container" style="display: none;">
                    <h4>Mapping Status</h4>
                    <p id="mappingMessage"></p>
                </div>
            </div>

            <!-- Data Transfer Tab -->
            <div id="transfer" class="form-section">
                <h2>Gatepass Data Transfer</h2>
                
                <div class="form-group">
                    <label>Gatepass Numbers (Comma Separated)</label>
                    <input type="text" id="gatepassNumbers" placeholder="GPJ1000214, GPJ1000215, GPJ1000216" value="GPJ1000214">
                </div>

                <button class="btn btn-success" onclick="fetchGatepassData()">Fetch Gatepass Details</button>

                <div id="gatepassContainer"></div>

                <div id="transferResult" class="result-container" style="display: none;">
                    <h4>Transfer Status</h4>
                    <p id="transferMessage"></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Application state management
        let appConfig = {
            unicommerce: {
                endpoint: "/services/rest/v1/purchase/gatepass/get",
                method: "POST",
                scheme: "HTTPS",
                token: "",
                facility: ""
            },
            logicERP: {
                endpoint: "http://demo.logicerp.com/api/SaveSaleInvoice",
                method: "POST",
                authType: "basic",
                username: "Demo",
                password: "1"
            },
            fieldMapping: {},
            gatepassData: []
        };

        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all sections
            document.querySelectorAll('.form-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected section and mark tab as active
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Save endpoint configuration
        function saveEndpoints() {
            appConfig.unicommerce.endpoint = document.getElementById('unicommerceEndpoint').value;
            appConfig.unicommerce.method = document.getElementById('unicommerceMethod').value;
            appConfig.unicommerce.scheme = document.getElementById('unicommerceScheme').value;
            appConfig.unicommerce.token = document.getElementById('unicommerceToken').value;
            appConfig.unicommerce.facility = document.getElementById('unicommerceFacility').value;

            appConfig.logicERP.endpoint = document.getElementById('logicEndpoint').value;
            appConfig.logicERP.method = document.getElementById('logicMethod').value;
            appConfig.logicERP.authType = document.getElementById('logicAuthType').value;
            appConfig.logicERP.username = document.getElementById('logicUsername').value;
            appConfig.logicERP.password = document.getElementById('logicPassword').value;

            showResult('endpointResult', 'endpointMessage', 'Configuration saved successfully!', 'success');
        }

        // Save parameters configuration
        function saveParameters() {
            try {
                const unicommerceParams = document.getElementById('unicommerceParams').value;
                const logicParams = document.getElementById('logicParams').value;
                
                // Validate JSON
                JSON.parse(unicommerceParams);
                JSON.parse(logicParams);
                
                appConfig.unicommerceParams = unicommerceParams;
                appConfig.logicParams = logicParams;
                
                showResult('parameterResult', 'parameterMessage', 'Parameters saved successfully!', 'success');
            } catch (error) {
                showResult('parameterResult', 'parameterMessage', 'Error: Invalid JSON format', 'error');
            }
        }

        // Save field mapping
        function saveMapping() {
            try {
                const customMapping = document.getElementById('customMapping').value;
                appConfig.fieldMapping = JSON.parse(customMapping);
                showResult('mappingResult', 'mappingMessage', 'Field mapping saved successfully!', 'success');
            } catch (error) {
                showResult('mappingResult', 'mappingMessage', 'Error: Invalid JSON format in custom mapping', 'error');
            }
        }

        // Fetch gatepass data (simulation)
        async function fetchGatepassData() {
            const gatepassNumbers = document.getElementById('gatepassNumbers').value.split(',').map(s => s.trim());
            
            if (!gatepassNumbers.length || !gatepassNumbers[0]) {
                showResult('transferResult', 'transferMessage', 'Please enter gatepass numbers', 'error');
                return;
            }

            showResult('transferResult', 'transferMessage', '<div class="loading"></div> Fetching gatepass data...', '');
            
            // Simulate API call delay
            setTimeout(() => {
                const mockData = {
                    successful: true,
                    elements: [{
                        id: 12345,
                        code: gatepassNumbers[0],
                        statusCode: "RETURN_AWAITED",
                        type: "STOCK_TRANSFER",
                        toPartyName: "Unique Exports",
                        created: Date.now() - 86400000,
                        updated: Date.now(),
                        gatePassItemDTOs: [
                            {
                                itemCode: "2003061021238",
                                itemTypeName: "act44",
                                itemTypeSKU: "act44",
                                quantity: 1,
                                unitPrice: 84.75
                            },
                            {
                                itemCode: "2001031019660",
                                itemTypeName: "Test",
                                itemTypeSKU: "Test",
                                quantity: 1,
                                unitPrice: 1000
                            }
                        ]
                    }]
                };

                displayGatepassData(mockData);
                showResult('transferResult', 'transferMessage', 'Gatepass data fetched successfully!', 'success');
            }, 2000);
        }

        // Display gatepass data
        function displayGatepassData(data) {
            const container = document.getElementById('gatepassContainer');
            let html = '';

            data.elements.forEach(gatepass => {
                html += `
                    <div class="gatepass-entry">
                        <h3>Gatepass: ${gatepass.code}</h3>
                        
                        <div class="gatepass-details">
                            <div class="detail-item">
                                <div class="detail-label">Status</div>
                                <div class="detail-value">${gatepass.statusCode}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Type</div>
                                <div class="detail-value">${gatepass.type}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Party Name</div>
                                <div class="detail-value">${gatepass.toPartyName}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Created</div>
                                <div class="detail-value">${new Date(gatepass.created).toLocaleDateString()}</div>
                            </div>
                        </div>

                        <table class="items-table">
                            <thead>
                                <tr>
                                    <th>Item Code</th>
                                    <th>Item Name</th>
                                    <th>SKU</th>
                                    <th>Quantity</th>
                                    <th>Unit Price</th>
                                </tr>
                            </thead>
                            <tbody>
                `;

                gatepass.gatePassItemDTOs.forEach(item => {
                    html += `
                        <tr>
                            <td>${item.itemCode}</td>
                            <td>${item.itemTypeName}</td>
                            <td>${item.itemTypeSKU}</td>
                            <td>${item.quantity}</td>
                            <td>₹${item.unitPrice}</td>
                        </tr>
                    `;
                });

                html += `
                            </tbody>
                        </table>
                        
                        <button class="btn btn-success" onclick="transferToLogicERP('${gatepass.code}')" style="margin-top: 15px;">
                            Send to Logic ERP
                        </button>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // Transfer data to Logic ERP
        function transferToLogicERP(gatepassCode) {
            showResult('transferResult', 'transferMessage', '<div class="loading"></div> Transferring data to Logic ERP...', '');
            
            // Simulate API call
            setTimeout(() => {
                const logicERPPayload = {
                    Remarks3: "",
                    CreditDays: 0.0,
                    Sale_Bill_Date: "",
                    OrderNo: gatepassCode,
                    OrderDate: new Date().toLocaleDateString('en-GB'),
                    BillSeries: "WSL",
                    Bill_Number: 0,
                    Bill_Date: new Date().toLocaleDateString('en-GB'),
                    PartyUserCode: "99004477",
                    BranchCode: 2,
                    LstItems: [
                        {
                            LogicUserCode: "act44",
                            AddlItemCode: "2003061021238",
                            Quantity: 1.0,
                            Rate: 84.75,
                            CD_P: 0.0
                        },
                        {
                            LogicUserCode: "Test",
                            AddlItemCode: "2001031019660",
                            Quantity: 1.0,
                            Rate: 1000.0,
                            CD_P: 0.0
                        }
                    ]
                };

                console.log('Sending to Logic ERP:', logicERPPayload);
                showResult('transferResult', 'transferMessage', 
                    `Successfully transferred gatepass ${gatepassCode} to Logic ERP! 
                     <br><small>Mapped ${logicERPPayload.LstItems.length} items</small>`, 'success');
            }, 1500);
        }

        // Utility function to show results
        function showResult(containerId, messageId, message, type) {
            const container = document.getElementById(containerId);
            const messageEl = document.getElementById(messageId);
            
            container.style.display = 'block';
            container.className = `result-container ${type}`;
            messageEl.innerHTML = message;
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            console.log('API Integration Manager initialized');
        });
    </script>
</body>
</html>